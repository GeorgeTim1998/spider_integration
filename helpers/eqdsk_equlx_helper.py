import numpy as np
import math as mt
from math import pi

def write_np_array_to_file(file, array, number_format):
  columns = 5
  rows = mt.floor(len(array)/5)
  sep_index = columns*rows

  arr5 = array[0: sep_index]
  arrleftover = array[sep_index: :]

  arr5 = np.resize(arr5, (rows, columns))
  arrleftover = np.resize(arrleftover, (1, len(arrleftover)))
  np.savetxt(file, arr5, fmt=number_format, delimiter='')
  np.savetxt(file, arrleftover, fmt=number_format, delimiter='')
  
def restore_pres_n_fpol(um, up, meshr, pprime, ffprim, bcentr, rcentr):
  um = -um / (2*pi)
  up = -up / (2*pi)
  dpsi = (um - up)/(meshr-1)

  pres = np.zeros(len(pprime))
  fpol = np.zeros(len(pprime))
  fpol[-1] = bcentr * rcentr

  my_steps = np.flip(np.array(range(0, meshr-1)))
  for i in my_steps:
    pprim_c = -0.5 * (pprime[i+1] + pprime[i])
    fprim_c = -0.5 * (ffprim[i+1] + ffprim[i])
    
    pres[i]=(pres[i+1] + pprim_c * 2*pi*dpsi) # for some reason pres needs 2pi multiplicator to be actual pressure
    fpol[i]=mt.sqrt(fpol[i+1]**2 + 2*fprim_c * 2*pi*dpsi)

  return pres, fpol  

def default_ffprim():
  ffprim = np.array([0.999417939E+01, 0.867587335E+01, 0.743508148E+01, 0.695207210E+01, 0.657569454E+01,
                     0.629749948E+01, 0.603575254E+01, 0.583357886E+01, 0.563452217E+01, 0.546150704E+01,
                     0.529334016E+01, 0.514365366E+01, 0.499626043E+01, 0.486438730E+01, 0.473811418E+01,
                     0.461570973E+01, 0.450077253E+01, 0.439026714E+01, 0.428251854E+01, 0.417977053E+01,
                     0.408147937E+01, 0.398571004E+01, 0.389229592E+01, 0.380187895E+01, 0.371470496E+01,
                     0.363036779E+01, 0.354810259E+01, 0.346752112E+01, 0.338872287E+01, 0.331221237E+01,
                     0.323773116E+01, 0.316469114E+01, 0.309300816E+01, 0.302264966E+01, 0.295356410E+01,
                     0.288572434E+01, 0.281925283E+01, 0.275437377E+01, 0.269086394E+01, 0.262842895E+01,
                     0.256701983E+01, 0.250657815E+01, 0.244701795E+01, 0.238828344E+01, 0.233038564E+01,
                     0.227343443E+01, 0.221747784E+01, 0.216249287E+01, 0.210837582E+01, 0.205502311E+01,
                     0.200237930E+01, 0.195040213E+01, 0.189905573E+01, 0.184830359E+01, 0.179815156E+01,
                     0.174870963E+01, 0.170005559E+01, 0.165219784E+01, 0.160500625E+01, 0.155832478E+01,
                     0.151214135E+01, 0.146646540E+01, 0.142129133E+01, 0.137659656E+01, 0.133238359E+01,
                     0.128882043E+01, 0.124599020E+01, 0.120372527E+01, 0.116192131E+01, 0.112055432E+01,
                     0.107961533E+01, 0.103910788E+01, 0.999052991E+00, 0.959468650E+00, 0.920373405E+00,
                     0.881818016E+00, 0.843823765E+00, 0.806325328E+00, 0.769264603E+00, 0.732606981E+00,
                     0.696357684E+00, 0.660517176E+00, 0.625070175E+00, 0.590093788E+00, 0.555689447E+00,
                     0.521878675E+00, 0.488592171E+00, 0.455719963E+00, 0.423260670E+00, 0.391226511E+00,
                     0.359638374E+00, 0.328646675E+00, 0.298274038E+00, 0.268349746E+00, 0.238847659E+00,
                     0.209839462E+00, 0.181451176E+00, 0.153801161E+00, 0.126834781E+00, 0.100389498E+00,
                     0.744817446E-01, 0.494291817E-01, 0.253368376E-01, 0.180020262E-02,-0.212091973E-01,
                     -0.431993615E-01, -0.640161112E-01, -0.842876889E-01, -0.103681598E+00, -0.121748344E+00,
                     -0.138964642E+00, -0.155487616E+00, -0.170113015E+00, -0.184089489E+00, -0.196908518E+00,
                     -0.208350897E+00, -0.218901438E+00, -0.228207261E+00, -0.236299558E+00, -0.243714174E+00,
                     -0.250018929E+00, -0.256210321E+00, -0.262269054E+00, -0.268844714E+00, -0.276835486E+00,
                     -0.285875810E+00, -0.297368729E+00, -0.309533860E+00])
  
  return ffprim
  
def default_pprime():
  pprime = np.array([0.335012952E+06, 0.243038167E+06, 0.158384855E+06, 0.145245202E+06, 0.141143698E+06,
                     0.139608090E+06, 0.138323506E+06, 0.137958905E+06, 0.137633363E+06, 0.137612867E+06,
                     0.137643056E+06, 0.137846315E+06, 0.138071389E+06, 0.138413402E+06, 0.138794793E+06,
                     0.139198297E+06, 0.139647210E+06, 0.140118480E+06, 0.140604390E+06, 0.141114657E+06,
                     0.141645411E+06, 0.142186965E+06, 0.142738784E+06, 0.143303236E+06, 0.143881002E+06,
                     0.144470289E+06, 0.145068112E+06, 0.145672922E+06, 0.146285204E+06, 0.146907424E+06,
                     0.147538788E+06, 0.148177022E+06, 0.148821883E+06, 0.149473384E+06, 0.150131487E+06,
                     0.150796217E+06, 0.151468649E+06, 0.152150683E+06, 0.152841584E+06, 0.153540067E+06,
                     0.154246029E+06, 0.154959339E+06, 0.155679726E+06, 0.156406983E+06, 0.157141464E+06,
                     0.157884486E+06, 0.158637097E+06, 0.159399845E+06, 0.160172202E+06, 0.160953504E+06,
                     0.161743469E+06, 0.162541926E+06, 0.163348741E+06, 0.164163671E+06, 0.164987074E+06,
                     0.165820882E+06, 0.166666964E+06, 0.167526508E+06, 0.168397855E+06, 0.169278629E+06,
                     0.170168890E+06, 0.171069065E+06, 0.171979329E+06, 0.172899457E+06, 0.173829813E+06,
                     0.174774686E+06, 0.175736558E+06, 0.176712352E+06, 0.177700040E+06, 0.178699106E+06,
                     0.179709512E+06, 0.180731620E+06, 0.181766307E+06, 0.182814343E+06, 0.183876525E+06,
                     0.184954817E+06, 0.186050290E+06, 0.187161233E+06, 0.188285994E+06, 0.189423534E+06,
                     0.190574069E+06, 0.191737635E+06, 0.192913719E+06, 0.194104807E+06, 0.195313945E+06,
                     0.196540986E+06, 0.197783113E+06, 0.199036424E+06, 0.200300179E+06, 0.201574293E+06,
                     0.202858665E+06, 0.204154096E+06, 0.205458732E+06, 0.206767566E+06, 0.208079174E+06,
                     0.209393060E+06, 0.210707027E+06, 0.212013409E+06, 0.213306648E+06, 0.214585746E+06,
                     0.215850982E+06, 0.217081712E+06, 0.218263024E+06, 0.219407918E+06, 0.220521581E+06,
                     0.221558365E+06, 0.222493116E+06, 0.223372462E+06, 0.224166053E+06, 0.224805399E+06,
                     0.225340329E+06, 0.225784503E+06, 0.225959322E+06, 0.226027519E+06, 0.225909648E+06,
                     0.225538722E+06, 0.225003136E+06, 0.224185757E+06, 0.223086575E+06, 0.221755830E+06,
                     0.220014998E+06, 0.218083899E+06, 0.215712952E+06, 0.213132640E+06, 0.210123945E+06,
                     0.206875823E+06, 0.203154809E+06, 0.199302180E+06])
  
  return pprime
